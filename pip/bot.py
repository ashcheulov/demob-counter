import asyncio
from aiogram import Bot, Dispatcher, F
from aiogram.enums import ParseMode
from aiogram.types import (
    Message,
    ReplyKeyboardMarkup,
    KeyboardButton,
    WebAppInfo,
)
from aiogram.client.default import DefaultBotProperties

# üîí –¢–æ–∫–µ–Ω –æ—Ç BotFather
BOT_TOKEN = "7380534180:AAEBP2VcY363wUpiibe_k7MfPZtKxsEVTKE"

# üåê URL WebApp
WEBAPP_URL = "https://demob-counter.vercel.app"

# ‚úÖ –£–∫–∞–∑—ã–≤–∞–µ–º parse_mode –ø–æ-–Ω–æ–≤–æ–º—É
bot = Bot(
    token=BOT_TOKEN,
    default=DefaultBotProperties(parse_mode=ParseMode.HTML)
)

dp = Dispatcher()

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start –¥–ª—è –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
@dp.message(F.text == "/start")
async def start_handler(message: Message):
    keyboard = ReplyKeyboardMarkup(
        resize_keyboard=True,
        keyboard=[
            [
                KeyboardButton(
                    text="–û—Ç–∫—Ä—ã—Ç—å —Å—á—ë—Ç—á–∏–∫ –¥–µ–º–±–µ–ª—è",
                    web_app=WebAppInfo(url=WEBAPP_URL)
                )
            ]
        ]
    )
    await message.answer("–ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å —Å—á—ë—Ç—á–∏–∫ ‚è≥", reply_markup=keyboard)

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è —Å —Å—Å—ã–ª–∫–æ–π –Ω–∞ WebApp –≤ –≥—Ä—É–ø–ø–µ
@dp.message(F.text == "–û—Ç–∫—Ä—ã—Ç—å —Å—á—ë—Ç—á–∏–∫ –¥–µ–º–±–µ–ª—è")
async def send_webapp_link(message: Message):
    await message.answer(
        "–ù–∞–∂–º–∏ –Ω–∞ —Å—Å—ã–ª–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å —Å—á—ë—Ç—á–∏–∫ –¥–µ–º–±–µ–ª—è:",
        reply_markup=ReplyKeyboardMarkup(
            resize_keyboard=True,
            keyboard=[
                [KeyboardButton(text="–û—Ç–∫—Ä—ã—Ç—å WebApp", url=WEBAPP_URL)]
            ]
        )
    )

async def main():
    await dp.start_polling(bot)

if __name__ == "__main__":
    asyncio.run(main())
